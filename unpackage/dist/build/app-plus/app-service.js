if("undefined"==typeof Promise||Promise.prototype.finally||(Promise.prototype.finally=function(e){const t=this.constructor;return this.then((n=>t.resolve(e()).then((()=>n))),(n=>t.resolve(e()).then((()=>{throw n}))))}),"undefined"!=typeof uni&&uni&&uni.requireGlobal){const e=uni.requireGlobal();ArrayBuffer=e.ArrayBuffer,Int8Array=e.Int8Array,Uint8Array=e.Uint8Array,Uint8ClampedArray=e.Uint8ClampedArray,Int16Array=e.Int16Array,Uint16Array=e.Uint16Array,Int32Array=e.Int32Array,Uint32Array=e.Uint32Array,Float32Array=e.Float32Array,Float64Array=e.Float64Array,BigInt64Array=e.BigInt64Array,BigUint64Array=e.BigUint64Array}uni.restoreGlobal&&uni.restoreGlobal(Vue,weex,plus,setTimeout,clearTimeout,setInterval,clearInterval),function(e){"use strict";function t(e,t,...n){uni.__log__?uni.__log__(e,t,...n):console[e].apply(console,[...n,t])}
/*!
    * pinia v2.0.33
    * (c) 2023 Eduardo San Martin Morote
    * @license MIT
    */
let n;const i=e=>n=e,o=Symbol();function r(e){return e&&"object"==typeof e&&"[object Object]"===Object.prototype.toString.call(e)&&"function"!=typeof e.toJSON}var a,s;(s=a||(a={})).direct="direct",s.patchObject="patch object",s.patchFunction="patch function";const c="undefined"!=typeof window;function l(){const t=e.effectScope(!0),n=t.run((()=>e.ref({})));let r=[],a=[];const s=e.markRaw({install(e){i(s),s._a=e,e.provide(o,s),e.config.globalProperties.$pinia=s,a.forEach((e=>r.push(e))),a=[]},use(e){return this._a?r.push(e):a.push(e),this},_p:r,_a:null,_e:t,_s:new Map,state:n});return s}const u=()=>{};function d(t,n,i,o=u){t.push(n);const r=()=>{const e=t.indexOf(n);e>-1&&(t.splice(e,1),o())};return!i&&e.getCurrentScope()&&e.onScopeDispose(r),r}function p(e,...t){e.slice().forEach((e=>{e(...t)}))}function v(t,n){t instanceof Map&&n instanceof Map&&n.forEach(((e,n)=>t.set(n,e))),t instanceof Set&&n instanceof Set&&n.forEach(t.add,t);for(const i in n){if(!n.hasOwnProperty(i))continue;const o=n[i],a=t[i];r(a)&&r(o)&&t.hasOwnProperty(i)&&!e.isRef(o)&&!e.isReactive(o)?t[i]=v(a,o):t[i]=o}return t}const h=Symbol();const{assign:f}=Object;function g(t,n,o={},s,c,l){let g;const m=f({actions:{}},o),y={deep:!0};let x,E,V,b=e.markRaw([]),w=e.markRaw([]);const N=s.state.value[t];let A;function I(n){let i;x=E=!1,"function"==typeof n?(n(s.state.value[t]),i={type:a.patchFunction,storeId:t,events:V}):(v(s.state.value[t],n),i={type:a.patchObject,payload:n,storeId:t,events:V});const o=A=Symbol();e.nextTick().then((()=>{A===o&&(x=!0)})),E=!0,p(b,i,s.state.value[t])}l||N||(s.state.value[t]={}),e.ref({});const _=l?function(){const{state:e}=o,t=e?e():{};this.$patch((e=>{f(e,t)}))}:u;function C(e,n){return function(){i(s);const o=Array.from(arguments),r=[],a=[];function c(e){r.push(e)}function l(e){a.push(e)}let u;p(w,{args:o,name:e,store:B,after:c,onError:l});try{u=n.apply(this&&this.$id===t?this:B,o)}catch(d){throw p(a,d),d}return u instanceof Promise?u.then((e=>(p(r,e),e))).catch((e=>(p(a,e),Promise.reject(e)))):(p(r,u),u)}}const k={_p:s,$id:t,$onAction:d.bind(null,w),$patch:I,$reset:_,$subscribe(n,i={}){const o=d(b,n,i.detached,(()=>r())),r=g.run((()=>e.watch((()=>s.state.value[t]),(e=>{("sync"===i.flush?E:x)&&n({storeId:t,type:a.direct,events:V},e)}),f({},y,i))));return o},$dispose:function(){g.stop(),b=[],w=[],s._s.delete(t)}},B=e.reactive(k);s._s.set(t,B);const S=s._e.run((()=>(g=e.effectScope(),g.run((()=>n())))));for(const i in S){const n=S[i];if(e.isRef(n)&&($=n,!e.isRef($)||!$.effect)||e.isReactive(n))l||(!N||r(T=n)&&T.hasOwnProperty(h)||(e.isRef(n)?n.value=N[i]:v(n,N[i])),s.state.value[t][i]=n);else if("function"==typeof n){const e=C(i,n);S[i]=e,m.actions[i]=n}}var T,$;return f(B,S),f(e.toRaw(B),S),Object.defineProperty(B,"$state",{get:()=>s.state.value[t],set:e=>{I((t=>{f(t,e)}))}}),s._p.forEach((e=>{f(B,g.run((()=>e({store:B,app:s._a,pinia:s,options:m}))))})),N&&l&&o.hydrate&&o.hydrate(B.$state,N),x=!0,E=!0,B}function m(t,r,a){let s,c;const l="function"==typeof r;function u(t,a){const u=e.getCurrentInstance();(t=t||u&&e.inject(o,null))&&i(t),(t=n)._s.has(s)||(l?g(s,r,c,t):function(t,n,o,r){const{state:a,actions:s,getters:c}=n,l=o.state.value[t];let u;u=g(t,(function(){l||(o.state.value[t]=a?a():{});const n=e.toRefs(o.state.value[t]);return f(n,s,Object.keys(c||{}).reduce(((n,r)=>(n[r]=e.markRaw(e.computed((()=>{i(o);const e=o._s.get(t);return c[r].call(e,e)}))),n)),{}))}),n,o,0,!0)}(s,c,t));return t._s.get(s)}return"string"==typeof t?(s=t,c=l?a:r):(c=t,s=t.id),u.$id=s,u}let y="Store";function x(e,t){return Array.isArray(t)?t.reduce(((t,n)=>(t[n]=function(){return e(this.$pinia)[n]},t)),{}):Object.keys(t).reduce(((n,i)=>(n[i]=function(){const n=e(this.$pinia),o=t[i];return"function"==typeof o?o.call(this,n):n[o]},n)),{})}const E=x;const V=Object.freeze(Object.defineProperty({__proto__:null,get MutationType(){return a},PiniaVuePlugin:function(e){e.mixin({beforeCreate(){const e=this.$options;if(e.pinia){const t=e.pinia;if(!this._provided){const e={};Object.defineProperty(this,"_provided",{get:()=>e,set:t=>Object.assign(e,t)})}this._provided[o]=t,this.$pinia||(this.$pinia=t),t._a=this,c&&i(t)}else!this.$pinia&&e.parent&&e.parent.$pinia&&(this.$pinia=e.parent.$pinia)},destroyed(){delete this._pStores}})},acceptHMRUpdate:function(e,t){return()=>{}},createPinia:l,defineStore:m,getActivePinia:()=>e.getCurrentInstance()&&e.inject(o)||n,mapActions:function(e,t){return Array.isArray(t)?t.reduce(((t,n)=>(t[n]=function(...t){return e(this.$pinia)[n](...t)},t)),{}):Object.keys(t).reduce(((n,i)=>(n[i]=function(...n){return e(this.$pinia)[t[i]](...n)},n)),{})},mapGetters:E,mapState:x,mapStores:function(...e){return e.reduce(((e,t)=>(e[t.$id+y]=function(){return t(this.$pinia)},e)),{})},mapWritableState:function(e,t){return Array.isArray(t)?t.reduce(((t,n)=>(t[n]={get(){return e(this.$pinia)[n]},set(t){return e(this.$pinia)[n]=t}},t)),{}):Object.keys(t).reduce(((n,i)=>(n[i]={get(){return e(this.$pinia)[t[i]]},set(n){return e(this.$pinia)[t[i]]=n}},n)),{})},setActivePinia:i,setMapStoreSuffix:function(e){y=e},skipHydrate:function(e){return Object.defineProperty(e,h,{})},storeToRefs:function(t){{t=e.toRaw(t);const n={};for(const i in t){const o=t[i];(e.isRef(o)||e.isReactive(o))&&(n[i]=e.toRef(t,i))}return n}}},Symbol.toStringTag,{value:"Module"})),b=m("bluetoothInfo",(()=>{const t=e.ref(""),n=e.ref("0000FFE0-0000-1000-8000-00805F9B34FB"),i=e.ref("0000FFE1-0000-1000-8000-00805F9B34FB");return{deviceId:t,serviceId:n,characteristicId:i,changeDeviceId:e=>{t.value=e}}})),w={__name:"operate",setup(n){const i=b();let o=e.ref(null),r=e.ref(!1);const a=(e,t)=>{l(e,t)},s=(e,n)=>{t("log","at pages/operate/operate.vue:20","长按"),r.value=!0,o.value=setInterval((()=>{l(e,n)}),400)},c=()=>{r.value=!1,clearInterval(o.value),o.value=null;let e=setTimeout((()=>{l(),clearTimeout(e)}),400)},l=(e=null,n=null)=>{const o=new ArrayBuffer(9);if(null!==e&&null!==n){const i=new DataView(o);for(let r=0;r<o.byteLength;r++)r==e&&(t("log","at pages/operate/operate.vue:57","ok"),i.setUint16(r,parseInt(n,16)))}uni.writeBLECharacteristicValue({deviceId:i.deviceId,serviceId:i.serviceId,characteristicId:i.characteristicId,value:o,success(e){t("log","at pages/operate/operate.vue:75","writeBLECharacteristicValue success",e.errMsg)}})};e.onMounted((()=>{t("log","at pages/operate/operate.vue:36","onload"),plus.screen.lockOrientation("landscape-primary")})),e.onUnmounted((()=>{t("log","at pages/operate/operate.vue:43","onUnload"),plus.screen.lockOrientation("portrait-primary")}));let u=e.ref(30);const d=e=>{t("log","at pages/operate/operate.vue:88","value 发生变化："+e.detail.value),u.value=e.detail.value;let n=u.value.toString(16);l(6,n)};return(t,n)=>(e.openBlock(),e.createElementBlock("view",{class:"operate"},[e.createElementVNode("view",{class:"front"},[e.createElementVNode("ul",null,[e.createElementVNode("li",null,[e.createElementVNode("div",{class:"title"},"1"),e.createElementVNode("div",{class:"btn"},[e.createElementVNode("button",{style:{width:"80px",height:"52px"},onClick:n[0]||(n[0]=e=>a(0,"11")),onLongpress:n[1]||(n[1]=e=>s(0,"11")),onTouchend:c},"+",32),e.createElementVNode("button",{style:{width:"80px",height:"52px"},onClick:n[2]||(n[2]=e=>a(0,"10")),onLongpress:n[3]||(n[3]=e=>s(0,"10")),onTouchend:c},"-",32)])]),e.createElementVNode("li",null,[e.createElementVNode("div",{class:"title"},"2"),e.createElementVNode("div",{class:"btn"},[e.createElementVNode("button",{style:{width:"80px",height:"52px"},onClick:n[4]||(n[4]=e=>a(1,"21")),onLongpress:n[5]||(n[5]=e=>s(1,"21")),onTouchend:c},"+",32),e.createElementVNode("button",{style:{width:"80px",height:"52px"},onClick:n[6]||(n[6]=e=>a(1,"20")),onLongpress:n[7]||(n[7]=e=>s(1,"20")),onTouchend:c},"-",32)])]),e.createElementVNode("li",null,[e.createElementVNode("div",{class:"title"},"3"),e.createElementVNode("div",{class:"btn"},[e.createElementVNode("button",{style:{width:"80px",height:"52px"},onClick:n[8]||(n[8]=e=>a(2,"31")),onLongpress:n[9]||(n[9]=e=>s(2,"31")),onTouchend:c},"+",32),e.createElementVNode("button",{style:{width:"80px",height:"52px"},onClick:n[10]||(n[10]=e=>a(2,"30")),onLongpress:n[11]||(n[11]=e=>s(2,"30")),onTouchend:c},"-",32)])]),e.createElementVNode("li",null,[e.createElementVNode("div",{class:"title"},"速度"),e.createElementVNode("div",{class:"spd"},[e.createElementVNode("slider",{value:e.unref(u),onChange:d,min:"1",max:"100","show-value":""},null,40,["value"])])]),e.createElementVNode("li",null,[e.createElementVNode("div",{class:"title"},"喇叭"),e.createElementVNode("div",{class:"buzzer"},[e.createElementVNode("button",{style:{width:"50px",height:"50px","border-radius":"25px"},onClick:n[12]||(n[12]=e=>a(7,"71")),onLongpress:n[13]||(n[13]=e=>s(7,"71")),onTouchend:c},"di",32)])])])]),e.createElementVNode("view",{class:"direction"},[e.createElementVNode("ul",null,[e.createElementVNode("li",null,[e.createElementVNode("div",{class:"title"},"前后"),e.createElementVNode("div",{class:"fb btn"},[e.createElementVNode("button",{style:{width:"80px",height:"52px"},onClick:n[14]||(n[14]=e=>a(3,"41")),onLongpress:n[15]||(n[15]=e=>s(3,"41")),onTouchend:c},"+",32),e.createElementVNode("button",{style:{width:"80px",height:"52px"},onClick:n[16]||(n[16]=e=>a(3,"40")),onLongpress:n[17]||(n[17]=e=>s(3,"40")),onTouchend:c},"-",32)])]),e.createElementVNode("li",null,[e.createElementVNode("div",{class:"title"},"旋转"),e.createElementVNode("div",{class:"lr btn"},[e.createElementVNode("button",{style:{width:"80px",height:"52px"},onClick:n[18]||(n[18]=e=>a(4,"51")),onLongpress:n[19]||(n[19]=e=>s(4,"51")),onTouchend:c},"+",32),e.createElementVNode("button",{style:{width:"80px",height:"52px"},onClick:n[20]||(n[20]=e=>a(4,"50")),onLongpress:n[21]||(n[21]=e=>s(4,"50")),onTouchend:c},"-",32)])]),e.createElementVNode("li",null,[e.createElementVNode("div",{class:"title"},"左右"),e.createElementVNode("div",{class:"lr btn"},[e.createElementVNode("button",{type:"default",style:{width:"80px",height:"52px"},onClick:n[22]||(n[22]=e=>a(5,"61")),onLongpress:n[23]||(n[23]=e=>s(5,"61")),onTouchend:c},"+",32),e.createElementVNode("button",{type:"default",style:{width:"80px",height:"52px"},onClick:n[24]||(n[24]=e=>a(5,"60")),onLongpress:n[25]||(n[25]=e=>s(5,"60")),onTouchend:c},"-",32)])])])])]))}};__definePage("pages/index/index",{__name:"index",setup(n){const i=e.ref([]),o=b();function r(){uni.openBluetoothAdapter({success(e){t("log","at pages/index/index.vue:60","初始化蓝牙成功"),t("log","at pages/index/index.vue:61",e)},fail(e){t("log","at pages/index/index.vue:64","初始化蓝牙失败"),t("error","at pages/index/index.vue:65",e)}})}function a(){uni.startBluetoothDevicesDiscovery({success(e){t("log","at pages/index/index.vue:74","开始搜索"),uni.onBluetoothDeviceFound(s)},fail(e){t("log","at pages/index/index.vue:79","搜索失败"),t("error","at pages/index/index.vue:80",e)}})}function s(e){var n;t("log","at pages/index/index.vue:87",e),"Wky"===e.devices[0].name&&(n=e.devices[0].deviceId,i.value.forEach((e=>{if(n===e.deviceId)return!1})),1)&&i.value.push(e.devices[0])}const c=e.ref("");function l(e){t("log","at pages/index/index.vue:107",e),c.value=e.deviceId,o.changeDeviceId(e.deviceId),uni.createBLEConnection({deviceId:c.value,success(e){t("log","at pages/index/index.vue:115","连接成功"),t("log","at pages/index/index.vue:116",e),uni.stopBluetoothDevicesDiscovery({success(e){t("log","at pages/index/index.vue:138","停止成功"),t("log","at pages/index/index.vue:139",e)},fail(e){t("log","at pages/index/index.vue:142","停止失败"),t("error","at pages/index/index.vue:143",e)}}),uni.showToast({title:"连接成功"})},fail(e){t("log","at pages/index/index.vue:124","连接失败"),t("error","at pages/index/index.vue:125",e),uni.showToast({title:"连接成功",icon:"error"})}})}function u(){uni.getBLEDeviceServices({deviceId:c.value,success(e){t("log","at pages/index/index.vue:153",e),uni.showToast({title:"获取服务成功"})},fail(e){t("error","at pages/index/index.vue:159",e),uni.showToast({title:"获取服务失败",icon:"error"})}})}const d=e.ref("0000FFE0-0000-1000-8000-00805F9B34FB");function p(){uni.getBLEDeviceCharacteristics({deviceId:c.value,serviceId:d.value,success(e){t("log","at pages/index/index.vue:176",e),uni.showToast({title:"获取特征值成功"})},fail(e){t("error","at pages/index/index.vue:182",e),uni.showToast({title:"获取特征值失败",icon:"error"})}})}const v=e.ref("0000FFE1-0000-1000-8000-00805F9B34FB");function h(){uni.notifyBLECharacteristicValueChange({deviceId:c.value,serviceId:d.value,characteristicId:v.value,success(e){t("log","at pages/index/index.vue:200",e),uni.onBLECharacteristicValueChange((e=>{t("log","at pages/index/index.vue:252",e);let n=(i=e.value,Array.prototype.map.call(new Uint8Array(i),(function(e){return("00"+e.toString(16)).slice(-2)})).join(""));var i;t("log","at pages/index/index.vue:254",n),g.value=n;let o=function(e){var t,n=e.trim(),i="0x"===n.substr(0,2).toLowerCase()?n.substr(2):n,o=i.length;if(o%2!=0)return alert("存在非法字符!"),"";for(var r=[],a=0;a<o;a+=2)t=parseInt(i.substr(a,2),16),r.push(String.fromCharCode(t));return r.join("")}(n);t("log","at pages/index/index.vue:257",String(o)),f.value=String(o)})),uni.showToast({title:"已开启监听"})},fail(e){t("error","at pages/index/index.vue:207",e),uni.showToast({title:"监听失败",icon:"error"})}})}const f=e.ref(""),g=e.ref("");function m(){let e="hello";const n=new ArrayBuffer(e.length),i=new DataView(n);for(var o=0;o<e.length;o++)i.setUint8(o,e.charAt(o).charCodeAt());uni.writeBLECharacteristicValue({deviceId:c.value,serviceId:d.value,characteristicId:v.value,value:n,success(e){t("log","at pages/index/index.vue:282","writeBLECharacteristicValue success",e.errMsg),uni.showToast({title:"write指令发送成功"})},fail(e){t("error","at pages/index/index.vue:288",e),uni.showToast({title:"write指令发送失败",icon:"error"})}})}function y(){uni.readBLECharacteristicValue({deviceId:c.value,serviceId:d.value,characteristicId:v.value,success(e){t("log","at pages/index/index.vue:304",e),uni.showToast({title:"read指令发送成功"})},fail(e){t("error","at pages/index/index.vue:310",e),uni.showToast({title:"read指令发送失败",icon:"error"})}})}return(t,n)=>(e.openBlock(),e.createElementBlock("view",null,[e.createElementVNode("scroll-view",{"scroll-y":"",class:"box"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.value,(t=>(e.openBlock(),e.createElementBlock("view",{class:"item",onClick:e=>l(t)},[e.createElementVNode("view",null,[e.createElementVNode("text",null,"id: "+e.toDisplayString(t.deviceId),1)]),e.createElementVNode("view",null,[e.createElementVNode("text",null,"name: "+e.toDisplayString(t.name),1)])],8,["onClick"])))),256))]),e.createElementVNode("button",{onClick:r},"1 初始化蓝牙"),e.createElementVNode("button",{onClick:a},"2 搜索附近蓝牙设备"),e.createElementVNode("button",{onClick:u},"3 获取蓝牙服务"),e.createElementVNode("button",{onClick:p},"4 获取特征值"),e.createElementVNode("button",{onClick:h},"5 开启消息监听"),e.createElementVNode("button",{onClick:m},"6 发送数据"),e.createElementVNode("button",{onClick:y},"7 读取数据"),e.createElementVNode("view",{class:"msg_x"},[e.createElementVNode("view",{class:"msg_txt"}," 监听到的内容："+e.toDisplayString(f.value),1),e.createElementVNode("view",{class:"msg_hex"}," 监听到的内容（十六进制）："+e.toDisplayString(g.value),1)]),e.createElementVNode("navigator",{url:"/pages/operate/operate","hover-class":"other-navigator-hover"},[e.createElementVNode("button",{type:"default"},"跳转操作页面")])]))}}),__definePage("pages/operate/operate",w);const N={onLaunch:function(){t("log","at App.vue:4","App Launch")},onShow:function(){t("log","at App.vue:7","App Show")},onHide:function(){t("log","at App.vue:10","App Hide")}};const{app:A,Vuex:I,Pinia:_}=function(){const t=e.createVueApp(N);return t.use(l()),{app:t,Pinia:V}}();uni.Vuex=I,uni.Pinia=_,A.provide("__globalStyles",__uniConfig.styles),A._component.mpType="app",A._component.render=()=>{},A.mount("#app")}(Vue);
